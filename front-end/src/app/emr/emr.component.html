<div class="patient-details-container">
    <!-- Patient Information -->
    <section class="patient-info">
      <h2>Patient Information</h2>
      <table>
        <tr><td><strong>ID:</strong></td><td>{{ patient?.patient_id }}</td></tr>
        <tr><td><strong>Full Name:</strong></td><td>{{ patient?.full_name }}</td></tr>
        <tr><td><strong>Birth Date:</strong></td><td>{{ patient?.birth_date }}</td></tr>
        <tr><td><strong>Gender:</strong></td><td>{{ patient?.gender }}</td></tr>
        <tr><td><strong>Encounters:</strong></td><td>{{ patient?.encounter_count }}</td></tr>
        <tr><td><strong>Conditions:</strong></td><td>{{ conditions?.length }}</td></tr>
        <tr><td><strong>Observations:</strong></td><td>{{ observations?.length }}</td></tr>
        <tr><td><strong>Medication Requests:</strong></td><td>{{ medicationRequests?.length }}</td></tr>
        <tr><td><strong>Immunizations:</strong></td><td>{{ immunizations?.length }}</td></tr>
        <tr><td><strong>Care Plans:</strong></td><td>{{ carePlans?.length }}</td></tr>
      </table>
    </section>
  
    <!-- Expansion Panels -->
    <mat-accordion>
      <!-- Encounters -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>Encounters</mat-panel-title>
        </mat-expansion-panel-header>
        <table>
          <thead>
            <tr>
              <th>Encounter ID</th>
              <th>Start Date</th>
              <th>End Date</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let encounter of encounters">
              <td>{{ encounter.encounter_id }}</td>
              <td>{{ encounter.start_date }}</td>
              <td>{{ encounter.end_date }}</td>
              <td>{{ encounter.status }}</td>
              <td>
                <button (click)="viewEncounterDetails(encounter.encounter_id)">View Details</button>
              </td>
            </tr>
          </tbody>
        </table>
      </mat-expansion-panel>
  
      <!-- Observations -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>Observations</mat-panel-title>
        </mat-expansion-panel-header>
        <table>
          <thead>
            <tr>
              <th>Value Quantity</th>
              <th>Unit</th>
              <th>Date/Time</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let observation of observations">
              <td>{{ observation.value_quantity }}</td>
              <td>{{ observation.value_unit }}</td>
              <td>{{ observation.effective_datetime }}</td>
            </tr>
          </tbody>
        </table>
      </mat-expansion-panel>
  
      <!-- Immunizations -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>Immunizations</mat-panel-title>
        </mat-expansion-panel-header>
        <table>
          <thead>
            <tr>
              <th>Vaccine</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let immunization of immunizations">
              <td>{{ immunization.vaccine_code }}</td>
              <td>{{ immunization.occurrence_date }}</td>
            </tr>
          </tbody>
        </table>
      </mat-expansion-panel>
  
      <!-- Conditions -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>Conditions</mat-panel-title>
        </mat-expansion-panel-header>
        <table>
          <thead>
            <tr>
              <th>Condition</th>
              <th>Onset Date</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let condition of conditions">
              <td>{{ condition.code_text }}</td>
              <td>{{ condition.onset_datetime }}</td>
            </tr>
          </tbody>
        </table>
      </mat-expansion-panel>
  
      <!-- Care Plans -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>Care Plans</mat-panel-title>
        </mat-expansion-panel-header>
        <table>
          <thead>
            <tr>
              <th>Title</th>
              <th>Start Date</th>
              <th>End Date</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let carePlan of carePlans">
              <td>{{ carePlan.title }}</td>
              <td>{{ carePlan.start_date }}</td>
              <td>{{ carePlan.end_date }}</td>
            </tr>
          </tbody>
        </table>
      </mat-expansion-panel>
    </mat-accordion>
  </div>
  